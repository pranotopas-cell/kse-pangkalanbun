<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PT Khatulistiwa Sinar Energi | Corporate Portal</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <style>
        body { font-family: 'Plus Jakarta Sans', sans-serif; letter-spacing: -0.01em; }
        .section { display: none; opacity: 0; transform: translateY(20px); transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1); }
        .section.active { display: block; opacity: 1; transform: translateY(0); }
        .glass-nav { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(12px); }
        .hero-gradient { background: linear-gradient(135deg, #064e3b 0%, #022c22 100%); }
        .card-hover { transition: all 0.3s ease; }
        .card-hover:hover { transform: translateY(-5px); box-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.1); }
    </style>
</head>
<body class="bg-[#F8FAFC] text-[#1E293B]">

    <nav class="sticky top-0 z-50 glass-nav border-b border-slate-200">
        <div class="container mx-auto px-8 py-5 flex justify-between items-center">
            <div class="flex items-center space-x-4 cursor-pointer" onclick="showSection('home')">
                <div class="w-12 h-12 bg-[#064e3b] rounded-xl flex items-center justify-center font-extrabold text-white text-xl shadow-inner">KSE</div>
                <div>
                    <span class="text-2xl font-black tracking-tighter text-[#064e3b] uppercase block leading-none">PT KSE</span>
                    <span class="text-[10px] font-bold text-slate-400 tracking-[0.2em] uppercase">Energy Solutions</span>
                </div>
            </div>
            
            <div class="hidden md:flex items-center space-x-10 font-bold text-sm tracking-wide">
                <button onclick="showSection('home')" class="text-slate-500 hover:text-[#064e3b] transition">BERANDA</button>
                <button onclick="showSection('harga-pertamina')" class="text-slate-500 hover:text-[#064e3b] transition">HARGA BBM</button>
                
                <div id="nav-auth-container" class="border-l border-slate-200 pl-10 flex items-center">
                    <button id="btn-login-view" onclick="showSection('login')" class="bg-[#064e3b] text-white px-8 py-3 rounded-full hover:bg-emerald-800 transition shadow-lg shadow-emerald-900/20">ADMIN PORTAL</button>
                    
                    <div id="user-logged-in" class="hidden flex items-center space-x-6">
                        <div class="text-right">
                            <p id="display-email" class="text-xs font-bold text-emerald-900"></p>
                            <button onclick="showSection('admin-harga')" class="text-[10px] font-black text-orange-600 hover:text-orange-700 uppercase tracking-tighter">Update Database</button>
                        </div>
                        <button onclick="handleLogout()" class="bg-slate-100 text-slate-600 p-3 rounded-full hover:bg-red-50 hover:text-red-600 transition">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7"></path></svg>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <main class="container mx-auto px-8">
        <section id="home" class="section active py-20">
            <div class="grid lg:grid-cols-2 gap-16 items-center">
                <div>
                    <span class="inline-block px-4 py-2 bg-emerald-100 text-emerald-800 rounded-lg text-xs font-bold mb-6 tracking-widest uppercase italic">Official Industry Distributor</span>
                    <h1 class="text-7xl font-extrabold text-slate-900 leading-[0.95] tracking-tighter mb-8">
                        POWERING <br><span class="text-[#064e3b] italic">PROGRESS</span> <br>EVERYWHERE.
                    </h1>
                    <p class="text-xl text-slate-500 font-medium mb-10 leading-relaxed">Penyedia solusi bahan bakar industri terintegrasi dengan komitmen pada transparansi harga dan efisiensi logistik nasional.</p>
                    <div class="flex space-x-4">
                        <button onclick="showSection('harga-pertamina')" class="bg-[#064e3b] text-white px-10 py-5 rounded-2xl font-bold hover:scale-105 transition shadow-2xl shadow-emerald-900/30">Cek Harga Hari Ini</button>
                    </div>
                </div>
                <div class="relative">
                    <div class="absolute -inset-4 bg-emerald-500/10 rounded-[3rem] blur-2xl"></div>
                    <img src="https://images.unsplash.com/photo-1611273233597-ed6731d22372?auto=format&fit=crop&w=1000&q=80" class="relative rounded-[3rem] shadow-2xl border-white border-[12px] object-cover h-[500px] w-full">
                </div>
            </div>
        </section>

        <section id="harga-pertamina" class="section py-10">
            <div class="max-w-4xl mx-auto text-center mb-16">
                <h2 class="text-4xl font-black text-slate-900 mb-4 tracking-tighter uppercase italic">Indeks Harga BBM Industri</h2>
                <div class="h-1.5 w-24 bg-orange-500 mx-auto rounded-full mb-6"></div>
                <p class="text-slate-500 font-semibold uppercase tracking-widest text-xs">Informasi harga diperbarui secara realtime dari database pusat</p>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
                <script>
                    for(let i=1; i<=4; i++){
                        document.write(`
                            <div id="cardwilayah${i}" class="bg-white p-10 rounded-[2.5rem] border border-slate-100 shadow-sm card-hover">
                                <div class="flex justify-between items-start mb-10">
                                    <div class="w-10 h-10 bg-slate-50 rounded-lg flex items-center justify-center font-black text-slate-300">0${i}</div>
                                    <span class="text-[10px] font-black text-slate-400 uppercase tracking-widest">Zone Region</span>
                                </div>
                                <h3 class="text-lg font-bold text-slate-800 mb-2 uppercase italic tracking-tighter">Wilayah ${i}</h3>
                                <p class="text-4xl font-black text-[#064e3b] mb-6 tracking-tighter">Rp 0</p>
                                <div class="keteranganKmr text-[11px] font-black py-2 px-4 rounded-xl bg-slate-50 text-slate-400 inline-block">SINKRONISASI...</div>
                            </div>
                        `);
                    }
                </script>
            </div>
        </section>

        <section id="admin-harga" class="section py-10">
            <div class="max-w-2xl mx-auto bg-white p-12 rounded-[3rem] shadow-2xl border border-slate-100">
                <div class="mb-10">
                    <h2 class="text-3xl font-black text-slate-900 tracking-tighter uppercase italic">Control Panel</h2>
                    <p class="text-orange-600 font-bold text-xs uppercase tracking-widest mt-2">Update Indeks Harga Wilayah</p>
                </div>
                <div class="grid grid-cols-2 gap-8">
                    <div class="space-y-2">
                        <label class="text-[11px] font-black text-slate-400 ml-4 uppercase">Region I</label>
                        <input type="number" id="input-w1" class="w-full bg-slate-50 border-2 border-transparent focus:border-orange-500 p-5 rounded-2xl outline-none font-black text-2xl transition-all">
                    </div>
                    <div class="space-y-2">
                        <label class="text-[11px] font-black text-slate-400 ml-4 uppercase">Region II</label>
                        <input type="number" id="input-w2" class="w-full bg-slate-50 border-2 border-transparent focus:border-orange-500 p-5 rounded-2xl outline-none font-black text-2xl transition-all">
                    </div>
                    <div class="space-y-2">
                        <label class="text-[11px] font-black text-slate-400 ml-4 uppercase">Region III</label>
                        <input type="number" id="input-w3" class="w-full bg-slate-50 border-2 border-transparent focus:border-orange-500 p-5 rounded-2xl outline-none font-black text-2xl transition-all">
                    </div>
                    <div class="space-y-2">
                        <label class="text-[11px] font-black text-slate-400 ml-4 uppercase">Region IV</label>
                        <input type="number" id="input-w4" class="w-full bg-slate-50 border-2 border-transparent focus:border-orange-500 p-5 rounded-2xl outline-none font-black text-2xl transition-all">
                    </div>
                </div>
                <button onclick="saveHargaBaru()" class="w-full mt-10 bg-orange-600 text-white font-black py-6 rounded-2xl shadow-xl shadow-orange-900/20 hover:bg-orange-700 transition transform hover:-translate-y-1">PUBLISH KE PUBLIK</button>
            </div>
        </section>

        <section id="login" class="section py-20">
            <div class="max-w-md mx-auto bg-white p-12 rounded-[3rem] shadow-2xl border border-slate-100 text-center">
                <div class="w-20 h-20 bg-emerald-50 rounded-3xl flex items-center justify-center mx-auto mb-8 shadow-inner">
                    <svg class="w-10 h-10 text-emerald-900" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path></svg>
                </div>
                <h2 class="text-3xl font-black text-slate-900 mb-2 tracking-tighter">ADMIN ACCESS</h2>
                <p class="text-slate-400 text-sm font-semibold mb-10 tracking-wide uppercase">Masukkan kredensial Supabase Anda</p>
                <div class="space-y-5 text-left">
                    <input type="email" id="email" class="w-full bg-slate-50 border-none p-5 rounded-2xl focus:ring-4 focus:ring-emerald-500/20 outline-none font-bold" placeholder="Email Admin">
                    <input type="password" id="password" class="w-full bg-slate-50 border-none p-5 rounded-2xl focus:ring-4 focus:ring-emerald-500/20 outline-none font-bold" placeholder="Password">
                    <button id="btn-do-login" onclick="handleLogin()" class="w-full bg-[#064e3b] text-white py-5 rounded-2xl font-black shadow-xl shadow-emerald-900/30 hover:scale-[1.02] transition transform">Otorisasi Sesi</button>
                </div>
            </div>
        </section>

        <section id="dashboard" class="section py-10">
            <div class="flex justify-between items-center mb-10">
                <h2 class="text-4xl font-black text-slate-900 italic tracking-tighter uppercase">Repository Dokumen</h2>
                <div class="bg-emerald-100 text-emerald-800 px-6 py-2 rounded-full font-bold text-xs uppercase">Connected to Storage</div>
            </div>
            <div class="bg-white rounded-[2.5rem] shadow-sm border border-slate-100 overflow-hidden">
                <table class="w-full text-left">
                    <thead class="bg-slate-50 border-b border-slate-100 text-slate-400 text-[10px] font-black uppercase tracking-[0.2em]">
                        <tr><th class="px-10 py-6">Kategori</th><th class="px-10 py-6">Nama File</th><th class="px-10 py-6 text-center">Tindakan</th></tr>
                    </thead>
                    <tbody id="file-table-body" class="divide-y divide-slate-50">
                        </tbody>
                </table>
            </div>
        </section>
    </main>

    <footer class="mt-20 py-10 border-t border-slate-200 text-center">
        <p class="text-[10px] font-black text-slate-300 tracking-[0.3em] uppercase">PT Khatulistiwa Sinar Energi &copy; 2026</p>
    </footer>

    <script>
        // -- KONFIGURASI SUPABASE (Kredensial Baru Anda) --
        const SUPABASE_URL = "https://wrkmmeojhqpxchetaltl.supabase.co";
        const SUPABASE_KEY = "sb_publishable_HAdGJewkvKqOZ0cX7qPSZw_DjMDcATK";
        const _supabase = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

        // -- KONFIGURASI FIREBASE (FIRESTORE) --
        const firebaseConfig = {
            apiKey: "AIzaSyDenqfuE7Sjy773lp3k7WYh_3RRSr3nojM",
            authDomain: "kse-harga-bbm-update.firebaseapp.com",
            projectId: "kse-harga-bbm-update",
            storageBucket: "kse-harga-bbm-update.firebasestorage.app",
            messagingSenderId: "764165984284",
            appId: "1:764165984284:web:a74aed43317539f5f1cfd9"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // -- UI NAV LOGIC --
        function showSection(id) {
            document.querySelectorAll('.section').forEach(s => {
                s.classList.remove('active');
                s.style.display = 'none';
            });
            const target = document.getElementById(id);
            if (target) {
                target.style.display = 'block';
                setTimeout(() => target.classList.add('active'), 50);
            }
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // -- FIRESTORE REALTIME --
        let hargaSekarangGlobal = {};
        function initHargaRealtime() {
            db.collection("hargaBBM").doc("periode").onSnapshot((doc) => {
                if (!doc.exists) return;
                const data = doc.data();
                hargaSekarangGlobal = data.sekarang || {};

                for(let i=1; i<=4; i++) {
                    const w = `wilayah${i}`;
                    const now = parseInt(data.sekarang?.[w] || 0);
                    const prev = parseInt(data.kemarin?.[w] || 0);
                    const diff = now - prev;
                    const card = document.getElementById(`cardwilayah${i}`);
                    if (!card) continue;

                    card.querySelector('p').innerText = `Rp ${now.toLocaleString('id-ID')}`;
                    const ket = card.querySelector('.keteranganKmr');
                    
                    if(diff > 0) {
                        ket.innerText = `▲ NAIK RP ${diff.toLocaleString()}`;
                        ket.className = "keteranganKmr text-[11px] font-black py-2 px-4 rounded-xl bg-red-50 text-red-600";
                    } else if(diff < 0) {
                        ket.innerText = `▼ TURUN RP ${Math.abs(diff).toLocaleString()}`;
                        ket.className = "keteranganKmr text-[11px] font-black py-2 px-4 rounded-xl bg-emerald-50 text-emerald-600";
                    } else {
                        ket.innerText = "● HARGA STABIL";
                        ket.className = "keteranganKmr text-[11px] font-black py-2 px-4 rounded-xl bg-slate-100 text-slate-500";
                    }
                }
            });
        }

        async function saveHargaBaru() {
            const vals = {
                wilayah1: document.getElementById('input-w1').value,
                wilayah2: document.getElementById('input-w2').value,
                wilayah3: document.getElementById('input-w3').value,
                wilayah4: document.getElementById('input-w4').value
            };
            if(!vals.wilayah1 || !vals.wilayah2) return alert("Lengkapi data!");

            try {
                await db.collection("hargaBBM").doc("periode").update({
                    kemarin: hargaSekarangGlobal,
                    sekarang: vals
                });
                alert("DATABASE BERHASIL DIPERBARUI!");
                showSection('harga-pertamina');
            } catch (e) { alert("ERROR: Sesi login mungkin berakhir."); }
        }

        // -- SUPABASE AUTH LOGIC --
        async function handleLogin() {
            const email = document.getElementById('email').value.trim();
            const password = document.getElementById('password').value;
            const btn = document.getElementById('btn-do-login');

            btn.innerText = "AUTHENTICATING...";
            btn.disabled = true;

            const { data, error } = await _supabase.auth.signInWithPassword({ email, password });

            if (error) {
                alert("AKSES DITOLAK: " + error.message);
                btn.innerText = "OTORISASI SESI";
                btn.disabled = false;
            } else {
                updateUI(data.user);
            }
        }

        function updateUI(user) {
            if (!user) return;
            document.getElementById('btn-login-view').classList.add('hidden');
            document.getElementById('user-logged-in').classList.remove('hidden');
            document.getElementById('display-email').innerText = user.email;
            showSection('dashboard');
            loadDocuments();
        }

        async function loadDocuments() {
            const { data, error } = await _supabase.from('documents').select('*');
            const tbody = document.getElementById('file-table-body');
            
            if (error || !data) {
                tbody.innerHTML = `<tr><td colspan="3" class="px-10 py-20 text-center text-slate-300 font-bold uppercase tracking-widest italic">Dokumen belum diunggah</td></tr>`;
                return;
            }

            tbody.innerHTML = data.map(doc => `
                <tr class="hover:bg-slate-50 transition border-b border-slate-50">
                    <td class="px-10 py-8"><span class="bg-emerald-50 text-emerald-800 px-4 py-2 rounded-xl text-[10px] font-black uppercase tracking-tighter">${doc.type}</span></td>
                    <td class="px-10 py-8 text-sm font-black text-slate-700">${doc.name}</td>
                    <td class="px-10 py-8 text-center">
                        <a href="${doc.url}" target="_blank" class="bg-[#064e3b] text-white px-8 py-3 rounded-xl text-[10px] font-black hover:bg-black transition shadow-lg shadow-emerald-900/10">PREVIEW PDF</a>
                    </td>
                </tr>
            `).join('');
        }

        async function handleLogout() {
            await _supabase.auth.signOut();
            window.location.reload();
        }

        // -- BOOTSTRAP --
        window.addEventListener('DOMContentLoaded', async () => {
            initHargaRealtime();
            const { data: { session } } = await _supabase.auth.getSession();
            if (session) updateUI(session.user);
        });
    </script>
</body>
</html>






