<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PT Khatulistiwa Sinar Energi - Portal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    
    <style>
        .bg-hijau-tua { background-color: #064e3b; }
        .bg-hijau-tosca { background-color: #0d9488; }
        .text-hijau-tosca { color: #0d9488; }
        .section { display: none; }
        .section.active { display: block; }
        .group:hover .group-hover\:block { display: block; }
    </style>
</head>
<body class="bg-gray-50 text-gray-900 min-h-screen">

    <nav class="bg-hijau-tua text-white shadow-xl sticky top-0 z-50">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <div class="flex items-center space-x-3 cursor-pointer" onclick="showSection('home')">
                <div class="w-10 h-10 bg-hijau-tosca rounded-lg flex items-center justify-center font-bold shadow-lg text-white">KSE</div>
                <span class="text-xl font-bold tracking-tighter">PT KHATULISTIWA SINAR ENERGI</span>
            </div>
            
            <div class="hidden md:flex items-center space-x-6 font-medium">
                <button onclick="showSection('home')" class="hover:text-teal-300 transition">Home</button>
                
                <div class="relative group">
                    <button class="flex items-center hover:text-teal-300 outline-none">Berita</button>
                    <div class="absolute hidden group-hover:block bg-white text-gray-800 mt-0 w-56 rounded-md shadow-xl py-2 border-t-4 border-hijau-tosca">
                        <button onclick="showSection('harga-pertamina')" class="block px-4 py-2 w-full text-left hover:bg-teal-50">Update Harga Pertamina</button>
                    </div>
                </div>

                <div class="relative group">
                    <button class="flex items-center hover:text-teal-300 outline-none">Administrasi</button>
                    <div class="absolute hidden group-hover:block bg-white text-gray-800 mt-0 w-48 rounded-md shadow-xl py-2 border-t-4 border-hijau-tosca">
                        <button onclick="filterFiles('PO')" class="block px-4 py-2 w-full text-left hover:bg-teal-50">Purchase Order (PO)</button>
                        <button onclick="filterFiles('Surat Jalan')" class="block px-4 py-2 w-full text-left hover:bg-teal-50">Surat Jalan</button>
                        <button onclick="filterFiles('Invoice')" class="block px-4 py-2 w-full text-left hover:bg-teal-50">Invoice</button>
                        <button onclick="filterFiles('Faktur Pajak')" class="block px-4 py-2 w-full text-left hover:bg-teal-50">Faktur Pajak</button>
                    </div>
                </div>

                <div class="relative group">
                    <button class="flex items-center hover:text-teal-300 outline-none">Tentang Kami</button>
                    <div class="absolute hidden group-hover:block bg-white text-gray-800 mt-0 w-48 rounded-md shadow-xl py-2 border-t-4 border-hijau-tosca">
                        <button onclick="showSection('profile')" class="block px-4 py-2 w-full text-left hover:bg-teal-50">Profile</button>
                        <button onclick="showSection('visi-misi')" class="block px-4 py-2 w-full text-left hover:bg-teal-50">Visi & Misi</button>
                        <button onclick="showSection('legalitas')" class="block px-4 py-2 w-full text-left hover:bg-teal-50">Legalitas & Alamat</button>
                    </div>
                </div>
                
                <div id="nav-auth-container" class="border-l pl-6 border-teal-800">
                    <button id="btn-login-view" onclick="showSection('login')" class="bg-hijau-tosca px-6 py-1.5 rounded-full font-bold hover:bg-teal-500 shadow">Sign In</button>
                    <div id="user-logged-in" class="hidden flex items-center space-x-3">
                        <div class="text-right leading-tight">
                            <p id="display-email" class="text-sm font-bold text-teal-300"></p>
                        </div>
                        <button onclick="handleLogout()" class="bg-red-600 p-1.5 rounded-full hover:bg-red-700 shadow">
                            <svg class="w-4 h-4 text-white mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7"></path></svg>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <main class="container mx-auto px-6 py-10">

        <section id="home" class="section active text-center py-12">
            <h1 class="text-5xl font-black text-hijau-tua mb-4">MENGALIRKAN ENERGI TERBAIK</h1>
            <p class="text-gray-600 mb-10 max-w-2xl mx-auto italic">Penyedia solusi energi berkelanjutan untuk industri Indonesia.</p>
            <div class="relative group max-w-4xl mx-auto">
                <img src="https://images.unsplash.com/photo-1581094288338-2314dddb7ecc?auto=format&fit=crop&w=1200&q=80" class="w-full rounded-3xl shadow-2xl border-b-8 border-hijau-tosca transition transform group-hover:scale-[1.01]" alt="Solar Plant">
            </div>
        </section>

        <section id="harga-pertamina" class="section">
            <h2 class="text-3xl font-bold text-hijau-tua mb-2 text-center">UPDATE HARGA PUBLISH PERTAMINA</h2>
            <p class="text-center text-gray-500 mb-10">Data real-time dari Firebase</p>
            
            <div class="mb-12">
                <div class="bg-hijau-tua text-white px-6 py-2 rounded-t-xl inline-block font-bold">Periode 15 - 28 Februari 2026</div>
                <div class="grid md:grid-cols-3 gap-6">
                    <div class="bg-white p-8 rounded-b-xl rounded-r-xl shadow-lg border-l-8 border-hijau-tosca">
                        <h4 class="font-bold text-gray-400 uppercase text-xs tracking-widest">Wilayah 1 & 2</h4>
                        <p id="h-p1-w1" class="text-3xl font-black text-hijau-tua mt-2 italic">---</p>
                    </div>
                    <div class="bg-white p-8 rounded-xl shadow-lg border-l-8 border-hijau-tosca">
                        <h4 class="font-bold text-gray-400 uppercase text-xs tracking-widest">Wilayah 3</h4>
                        <p id="h-p1-w2" class="text-3xl font-black text-hijau-tua mt-2 italic">---</p>
                    </div>
                    <div class="bg-white p-8 rounded-xl shadow-lg border-l-8 border-hijau-tosca">
                        <h4 class="font-bold text-gray-400 uppercase text-xs tracking-widest">Wilayah 4</h4>
                        <p id="h-p1-w3" class="text-3xl font-black text-hijau-tua mt-2 italic">---</p>
                    </div>
                </div>
            </div>

            <div>
                <div class="bg-gray-400 text-white px-6 py-2 rounded-t-xl inline-block font-bold">Periode 01 - 14 Februari 2026</div>
                <div class="grid md:grid-cols-3 gap-6">
                    <div class="bg-white p-8 rounded-b-xl rounded-r-xl shadow-md border-l-8 border-gray-300">
                        <h4 class="font-bold text-gray-400 uppercase text-xs tracking-widest">Wilayah 1 & 2</h4>
                        <p id="h-p2-w1" class="text-3xl font-black text-gray-400 mt-2 italic">---</p>
                    </div>
                    <div class="bg-white p-8 rounded-xl shadow-md border-l-8 border-gray-300">
                        <h4 class="font-bold text-gray-400 uppercase text-xs tracking-widest">Wilayah 3</h4>
                        <p id="h-p2-w2" class="text-3xl font-black text-gray-400 mt-2 italic">---</p>
                    </div>
                    <div class="bg-white p-8 rounded-xl shadow-md border-l-8 border-gray-300">
                        <h4 class="font-bold text-gray-400 uppercase text-xs tracking-widest">Wilayah 4</h4>
                        <p id="h-p2-w3" class="text-3xl font-black text-gray-400 mt-2 italic">---</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="profile" class="section">
            <div class="bg-white p-12 rounded-3xl shadow-xl">
                <h2 class="text-3xl font-bold text-hijau-tua mb-4">Profil Perusahaan</h2>
                <p class="text-gray-600 leading-relaxed text-lg">PT Khatulistiwa Sinar Energi (KSE) adalah mitra strategis dalam penyediaan energi industri yang berfokus pada kualitas layanan dan ketepatan waktu distribusi. Kami percaya bahwa energi yang dikelola secara profesional adalah kunci pertumbuhan industri nasional.</p>
            </div>
        </section>

        <section id="visi-misi" class="section">
            <div class="grid md:grid-cols-2 gap-8">
                <div class="bg-hijau-tua text-white p-10 rounded-3xl">
                    <h2 class="text-2xl font-bold mb-4 italic text-teal-300">Visi</h2>
                    <p>Menjadi perusahaan energi terdepan di Indonesia yang mengutamakan keberlanjutan dan inovasi teknologi.</p>
                </div>
                <div class="bg-hijau-tosca text-white p-10 rounded-3xl">
                    <h2 class="text-2xl font-bold mb-4 italic">Misi</h2>
                    <ul class="list-disc ml-5 space-y-2">
                        <li>Memberikan layanan distribusi energi yang efisien.</li>
                        <li>Membangun ekosistem administrasi yang transparan.</li>
                        <li>Mendukung transisi energi hijau di Indonesia.</li>
                    </ul>
                </div>
            </div>
        </section>

        <section id="legalitas" class="section">
            <div class="bg-white p-10 rounded-3xl shadow-lg border-l-8 border-hijau-tua">
                <h2 class="text-3xl font-bold text-hijau-tua mb-8">Informasi Legalitas & Kontak</h2>
                <div class="grid md:grid-cols-2 gap-10">
                    <div class="bg-gray-50 p-6 rounded-2xl">
                        <h3 class="font-bold text-hijau-tosca mb-3 uppercase">Legalitas</h3>
                        <ul class="space-y-2 text-sm">
                            <li><strong>NIB:</strong> 128910111xxx</li>
                            <li><strong>NPWP:</strong> 01.234.567.8-xxx.000</li>
                            <li><strong>Izin:</strong> Niaga Umum BBM/Migas</li>
                        </ul>
                    </div>
                    <div class="space-y-5">
                        <h3 class="font-bold text-hijau-tosca uppercase">Kantor Kami</h3>
                        <p class="text-gray-600 italic">Jl. Khatulistiwa No. 10, Lantai 2, Jakarta Pusat, Indonesia.</p>
                        <a href="https://wa.me/6281234567890" target="_blank" class="inline-flex items-center bg-green-600 text-white px-8 py-4 rounded-2xl font-bold hover:bg-green-700 transition shadow-lg transform hover:-translate-y-1">
                            Hubungi Admin via WhatsApp
                        </a>
                    </div>
                </div>
            </div>
        </section>

        <section id="login" class="section">
            <div class="max-w-md mx-auto bg-white p-10 rounded-3xl shadow-2xl border-t-8 border-hijau-tua">
                <h2 class="text-2xl font-bold text-center mb-6">Internal Access</h2>
                <input type="email" id="email" class="w-full border-2 border-gray-100 p-4 rounded-xl mb-4 focus:border-hijau-tosca outline-none" placeholder="Email">
                <input type="password" id="password" class="w-full border-2 border-gray-100 p-4 rounded-xl mb-6 focus:border-hijau-tosca outline-none" placeholder="Password">
                <button onclick="handleLogin()" class="w-full bg-hijau-tua text-white py-4 rounded-xl font-bold">Sign In</button>
            </div>
        </section>

        <section id="dashboard" class="section">
            <div class="flex flex-col md:flex-row justify-between mb-8 gap-4">
                <h2 id="dash-title" class="text-3xl font-bold text-hijau-tua italic">Pusat Dokumen</h2>
                <div id="admin-panel" class="hidden flex gap-2">
                    <select id="docType" class="border p-2 rounded-lg text-sm"><option value="PO">PO</option><option value="Surat Jalan">Surat Jalan</option><option value="Invoice">Invoice</option><option value="Faktur Pajak">Faktur Pajak</option></select>
                    <input type="file" id="fileInput" class="text-xs">
                    <button onclick="uploadFile()" class="bg-hijau-tosca text-white px-4 py-1 rounded-lg font-bold">Upload</button>
                </div>
            </div>
            <div class="bg-white rounded-3xl shadow border overflow-hidden">
                <table class="w-full text-left">
                    <thead class="bg-hijau-tua text-white"><tr><th class="px-6 py-4">Tipe</th><th class="px-6 py-4">Nama File</th><th class="px-6 py-4 text-center">Aksi</th></tr></thead>
                    <tbody id="file-table-body" class="divide-y italic"></tbody>
                </table>
            </div>
        </section>
    </main>

    <script>
        // -- DATA FIREBASE --
        const firebaseConfig = {
            apiKey: "AIzaSyDenqfuE7Sjy773lp3k7WYh_3RRSr3nojM",
            authDomain: "kse-harga-bbm-update.firebaseapp.com",
            projectId: "kse-harga-bbm-update",
            storageBucket: "kse-harga-bbm-update.firebasestorage.app",
            messagingSenderId: "764165984284",
            appId: "1:764165984284:web:a74aed43317539f5f1cfd9",
            databaseURL: "https://kse-harga-bbm-update-default-rtdb.firebaseio.com" // Menambahkan databaseURL agar fungsi database bekerja
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // -- CONFIG SUPABASE --
        const _supabase = supabase.createClient("https://secasrbeamduxqxwlspv.supabase.co", "sb_publishable_caJyFg1_Z89oUhtKg5XyoA_DfIgh6br");

        function showSection(id) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            window.scrollTo(0,0);
        }

        // -- LOAD HARGA DARI FIREBASE --
        function loadHarga() {
            db.ref('harga_pertamina').on('value', (snap) => {
                const val = snap.val();
                if (val) {
                    // Mapping data ke elemen (Sesuaikan path 'p1' dan 'p2' di Firebase Anda)
                    if(val.p1) {
                        document.getElementById('h-p1-w1').innerText = val.p1.w1 || "Rp 0";
                        document.getElementById('h-p1-w2').innerText = val.p1.w2 || "Rp 0";
                        document.getElementById('h-p1-w3').innerText = val.p1.w3 || "Rp 0";
                    }
                    if(val.p2) {
                        document.getElementById('h-p2-w1').innerText = val.p2.w1 || "Rp 0";
                        document.getElementById('h-p2-w2').innerText = val.p2.w2 || "Rp 0";
                        document.getElementById('h-p2-w3').innerText = val.p2.w3 || "Rp 0";
                    }
                }
            });
        }
        loadHarga();

        // -- LOGIN & DASHBOARD LOGIC --
        async function handleLogin() {
            const { data, error } = await _supabase.auth.signInWithPassword({
                email: document.getElementById('email').value,
                password: document.getElementById('password').value
            });
            if (error) return alert("Login Gagal");
            updateAuthUI(data.user);
        }

        function updateAuthUI(user) {
            if (!user) return;
            document.getElementById('btn-login-view').classList.add('hidden');
            document.getElementById('user-logged-in').classList.remove('hidden');
            document.getElementById('display-email').innerText = user.email;
            if (user.email.includes('admin')) document.getElementById('admin-panel').classList.remove('hidden');
            showSection('dashboard');
            loadFiles();
        }

        async function loadFiles() {
            const { data } = await _supabase.from('documents').select('*').order('created_at', { ascending: false });
            renderTable(data);
        }

        function renderTable(files) {
            const tbody = document.getElementById('file-table-body');
            tbody.innerHTML = files.map(f => `
                <tr class="hover:bg-gray-50">
                    <td class="px-6 py-4 font-bold text-hijau-tosca">${f.type}</td>
                    <td class="px-6 py-4 text-sm">${f.name}</td>
                    <td class="px-6 py-4 text-center"><a href="${f.url}" target="_blank" class="bg-hijau-tua text-white px-4 py-1.5 rounded-lg text-xs font-bold">Download</a></td>
                </tr>
            `).join('');
        }

        function filterFiles(type) {
            showSection('dashboard');
            document.getElementById('dash-title').innerText = "Filter: " + type;
            _supabase.from('documents').select('*').eq('type', type).then(({data}) => renderTable(data));
        }

        async function uploadFile() {
            const file = document.getElementById('fileInput').files[0];
            const type = document.getElementById('docType').value;
            if (!file) return;
            const path = `docs/${Date.now()}_${file.name}`;
            await _supabase.storage.from('kse-files').upload(path, file);
            const { data: urlData } = _supabase.storage.from('kse-files').getPublicUrl(path);
            await _supabase.from('documents').insert([{ name: file.name, type, url: urlData.publicUrl }]);
            alert("Berhasil!"); loadFiles();
        }

        async function handleLogout() { await _supabase.auth.signOut(); location.reload(); }

        _supabase.auth.getSession().then(({data}) => { if (data.session) updateAuthUI(data.session.user); });
    </script>
</body>
</html>



