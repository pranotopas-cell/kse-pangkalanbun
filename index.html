<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PT.KHATULISTIWA SINAR ENERGI</title>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<style>
*{box-sizing:border-box;margin:0;padding:0;font-family:Segoe UI,Arial,sans-serif;}
body{background:#20C997;color:#333;}
header{background:#0b3d2e;color:white;padding:15px 25px;display:flex;justify-content:space-between;align-items:center;position:sticky;top:0;z-index:100;}
header img{height:45px;}
nav a{color:white;margin-left:18px;text-decoration:none;font-weight:500;cursor:pointer;}
nav a:hover{text-decoration:underline;}
.hero{background:linear-gradient(rgba(0,0,0,.55),rgba(0,0,0,.55)),url('https://via.placeholder.com/1200x400') no-repeat center/cover;color:white;text-align:center;padding:90px 20px;}
.hero h1{font-size:40px;margin-bottom:10px;}
.btn{background:#ffc107;padding:12px 25px;border-radius:8px;text-decoration:none;color:black;font-weight:bold;display:inline-block;margin-top:15px;}
section{padding:50px 15px;}
.container{max-width:1100px;margin:auto;}
h2{text-align:center;margin-bottom:25px;}
.harga-box{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:15px;}
.card{background:white;padding:20px;border-radius:12px;text-align:center;box-shadow:0 4px 12px rgba(0,0,0,.08);position:relative;}
.card h3{margin:0;font-size:18px;}
.card p{font-size:22px;font-weight:bold;margin-top:8px;color:#0d6efd;}
.card small{display:block;margin-top:5px;}
.editBtn{position:absolute;top:10px;right:10px;cursor:pointer;font-size:18px;display:none;color:#ff6600;}
.tentang{background:white;border-radius:12px;padding:30px;box-shadow:0 4px 12px rgba(0,0,0,.08);line-height:1.7;}
.legal{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:15px;}
.legal div{background:white;padding:18px;border-radius:10px;box-shadow:0 3px 10px rgba(0,0,0,.08);}
.galeri{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:15px;}
.galeri img{width:100%;border-radius:10px;height:170px;object-fit:cover;}
footer{background:#0d6efd;color:white;text-align:center;padding:20px;font-size:14px;}
#docSection{display:none;margin-top:40px;}
#fileList p{margin:5px 0;}
#loginModal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.6);justify-content:center;align-items:center;z-index:200;}
#loginModal .modalContent{background:white;padding:30px;border-radius:10px;width:90%;max-width:400px;text-align:center;}
#loginModal input{width:100%;padding:10px;margin:10px 0;border-radius:5px;border:1px solid #ccc;}
#loginModal button{width:100%;padding:10px;margin-top:10px;}
</style>
</head>
<body>

<header>
<div style="display:flex;align-items:center;gap:12px">
<img src="logo.png" alt="Logo">
<b>PT.KHATULISTIWA SINAR ENERGI - Sinergi Mengalirkan Energi</b>
</div>
<nav>
<a href="#home">Home</a>
<a href="#harga">Harga</a>
<a href="#tentang">Tentang Kami</a>
<a href="#legalitas">Legalitas</a>
<a href="#galeri">Galeri</a>
<a href="#contact">Kontak</a>
<a id="loginNav">üîê Login</a>
</nav>
</header>

<section class="hero" id="home">
<h1>KHATULISTIWA SINAR ENERGI</h1> 
<h2>Mitra Penyalur dan Transportir BBM Industri</h2>
<p>Melayani Distribusi BBM Industri wilayah KalSel-Teng-Bar</p>
<a class="btn" href="https://wa.me/628158841410">üìû Contact Me</a>
</section>

<section id="harga">
<div class="container">
<h2>Harga Publish BBM Industri Pertamina</h2>
<p style="text-align:center;font-weight:bold">Periode Sekarang</p>
<div class="harga-box">
<div class="card" id="cardwilayah1"><h3>Wilayah I</h3><small>Sumatra, Jawa, Bali</small><p></p><small class="keteranganKmr"></small><span class="editBtn" id="editWilayah1">‚úèÔ∏è</span></div>
<div class="card" id="cardwilayah2"><h3>Wilayah II</h3><small>Kalimantan</small><p></p><small class="keteranganKmr"></small><span class="editBtn" id="editWilayah2">‚úèÔ∏è</span></div>
<div class="card" id="cardwilayah3"><h3>Wilayah III</h3><small>Sulawesi, NTB</small><p></p><small class="keteranganKmr"></small><span class="editBtn" id="editWilayah3">‚úèÔ∏è</span></div>
<div class="card" id="cardwilayah4"><h3>Wilayah IV</h3><small>Maluku, NTT, Papua</small><p></p><small class="keteranganKmr"></small><span class="editBtn" id="editWilayah4">‚úèÔ∏è</span></div>
</div>
</div>
</section>

<section id="tentang">
<div class="container">
<h2>About</h2>
<div class="tentang">
PT Khatulistiwa Sinar Energi bergerak di bidang distribusi BBM industri resmi. Pelayanan cepat, aman, handal dan terpercaya.
</div>
</div>
</section>

<section id="legalitas">
<div class="container">
<h2>Legalitas Perusahaan</h2>
<div class="legal">
<div><b>Nama Perusahaan</b><br>PT Khatulistiwa Sinar Energi<br>"sinergi mengalirkan energi"</div>
<div><b>NPWP</b><br>1000-0000-0773-4310<br>KPP Pratama Pangkalan Bun</div>
<div><b>NIB</b><br>1301-2600-7100-5<br>OSS RBA</div>
<div><b>Izin Niaga BBM</b><br>Terdaftar Resmi ke Niaga Umum</div>
</div>
</div>
</section>

<section id="galeri">
<div class="container">
<h2>Galeri Kegiatan</h2>
<div class="galeri">
<img src="https://galeri1.jpg">
<img src="https://galeri2.jpg">
<img src="https://galeri3.jpg">
<img src="https://galeri4.jpg">
</div>
</div>
</section>

<section id="contact">
<div class="container">
<h2>üìû Contact Me</h2>
<div class="tentang" style="text-align:center">
üìç JL.H.M Rafi'i Rt.24 Pangkalan Bun, Kalimantan Tengah<br><br>
üì± Noto : 08158841410<br><br>
üìß Email: pt.khatulistiwa.sinar.energi@gmail.com
</div>
</div>
</section>

<!-- Dokumen Section Supabase -->
<section id="docSection" class="container">
<h2>Dokumen</h2>
<input type="file" id="fileInput">
<input type="text" id="typeInput" placeholder="Tipe Dokumen">
<button id="uploadBtn">Upload</button>
<div id="fileList"></div>
</section>

<footer>¬© 2026 PT Khatulistiwa Sinar Energi ‚Äì All Rights Reserved</footer>

<!-- Login Modal -->
<div id="loginModal">
<div class="modalContent">
<h2>Login</h2>
<input type="email" id="email" placeholder="Email">
<input type="password" id="password" placeholder="Password">
<button id="loginSubmit">Login</button>
<button onclick="closeLogin()" style="background:#ccc;color:black;">Batal</button>
</div>
</div>

<script type="module">
// ===== FIREBASE =====
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
import { getFirestore, doc, getDoc, updateDoc } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";
const firebaseConfig = {apiKey:"AIzaSyDenqfuE7Sjy773lp3k7WYh_3RRSr3nojM",authDomain:"kse-harga-bbm-update.firebaseapp.com",projectId:"kse-harga-bbm-update",storageBucket:"kse-harga-bbm-update.firebasestorage.app",messagingSenderId:"764165984284",appId:"1:764165984284:web:a74aed43317539f1cfd9",measurementId:"G-ZGQ5LG6DH9"};
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const ref = doc(db,"hargaBBM","periode");
const wilayah=["wilayah1","wilayah2","wilayah3","wilayah4"];
let adminLoggedIn=false;
async function loadHarga(){
  const snap = await getDoc(ref);
  if(!snap.exists()) return;
  const data = snap.data();
  for(let i=0;i<wilayah.length;i++){
    let w=wilayah[i];
    let now=parseInt(data.sekarang[w])||0;
    let prev=parseInt(data.kemarin[w])||0;
    let selisih=now-prev;
    let warna,keterangan;
    if(selisih>0){warna="red";keterangan=`‚ñ≤ Naik Rp ${selisih.toLocaleString()}`;}
    else if(selisih<0){warna="green";keterangan=`‚ñº Turun Rp ${Math.abs(selisih).toLocaleString()}`;}
    else{warna="gray";keterangan="‚óè Tidak berubah";}
    const card=document.querySelector(`#card${w}`);
    card.querySelector("p").innerText=`Rp ${now.toLocaleString()}`;
    card.querySelector(".keteranganKmr").innerText=`Rp ${prev.toLocaleString()} ${keterangan}`;
    card.querySelector(".editBtn").style.display=adminLoggedIn?"block":"none";
    card.querySelector(".editBtn").onclick=()=>editHarga(w);
  }
}
loadHarga();
window.editHarga=async function(wil){
  if(!adminLoggedIn) return alert("Hanya admin bisa edit harga");
  const newVal=prompt(`Update harga ${wil}:`);
  if(newVal===null) return;
  const val=parseInt(newVal)||0;
  const snap=await getDoc(ref);
  const data=snap.data();
  const baru={...data.sekarang};
  baru[wil]=val;
  await updateDoc(ref,{sekarang:baru});
  loadHarga();
};
document.getElementById("loginBtn").addEventListener("click",()=>loginModal.style.display="flex");

// ===== SUPABASE =====
const supabaseClient = window.supabase.createClient(
 "https://secasrbeamduxqxwlspv.supabase.co",
 "sb_publishable_caJyFg1_Z89oUhtKg5XyoA_DfIgh6br"
);
const loginModal=document.getElementById("loginModal");
const loginNav=document.getElementById("loginNav");
const loginSubmit=document.getElementById("loginSubmit");
const uploadBtn=document.getElementById("uploadBtn");
const docSection=document.getElementById("docSection");
async function closeLogin(){loginModal.style.display="none";}
loginSubmit.addEventListener("click",async()=>{
  const email=document.getElementById("email").value;
  const password=document.getElementById("password").value;
  const { data,error }=await supabaseClient.auth.signInWithPassword({email,password});
  if(error){alert("Login gagal: "+error.message);return;}
  const { data:userData }=await supabaseClient.auth.getUser();
  const user=userData.user;
  if(!user) return;
  docSection.style.display="block";
  if(user.email==="admin@kse.com"){adminLoggedIn=true;uploadBtn.style.display="inline-block";uploadBtn.onclick=uploadFile;alert("Login Admin berhasil!");}
  else{adminLoggedIn=false;uploadBtn.style.display="none";alert("Login User berhasil!");}
  loginModal.style.display="none";
  loginNav.innerText="Sign Out";
  loginNav.onclick=async()=>{await supabaseClient.auth.signOut();location.reload();}
  loadHarga();
  loadFiles();
});

async function uploadFile(){
  const file=document.getElementById("fileInput").files[0];
  const type=document.getElementById("typeInput").value;
  const { data:userData}=await supabaseClient.auth.getUser();
  const user=userData.user;
  if(!file) return alert("Pilih file dulu");
  const filePath=`${user.email}/${file.name}`;
  const { error: uploadError }=await supabaseClient.storage.from("documents").upload(filePath,file,{upsert:true});
  if(uploadError) return alert("Upload gagal: "+uploadError.message);
  const { data: publicURL}=supabaseClient.storage.from("documents").getPublicUrl(filePath);
  await supabaseClient.from("documents").insert([{pt_email:user.email,type:type,file_name:file.name,file_url:publicURL.publicUrl}]);
  alert("Upload berhasil");
  loadFiles();
}

async function loadFiles(){
  const { data:userData }=await supabaseClient.auth.getUser();
  const user=userData.user;
  let query=supabaseClient.from("documents").select("*");
  if(!adminLoggedIn){query=query.eq("pt_email",user.email);}
  const { data,error }=await query;
  if(error) return console.error(error);
  const tbody=document.getElementById("fileList");
  tbody.innerHTML="";
  if(!data||data.length===0){tbody.innerHTML="<p>Belum ada dokumen</p>";}
  else{data.forEach(f=>{tbody.innerHTML+=`<p>${f.file_name} - ${f.type} <a href="${f.file_url}" target="_blank">Lihat</a></p>`;});}
}
</script>

</body>
</html>




